"0","require(pscl)"
"0","options(scipen = 999)"
"0","train <- train%>%mutate(female = case_when(Sex=='female' ~ 1,"
"0","                                  T ~ 0),"
"0","                        child = case_when(Age <= 10 ~ 1,"
"0","                                 T ~ 0),"
"0","                        )"
"0","formula <- Survived ~ Pclass + female + child"
"0","fit <- glm(formula,data=train,family = binomial(link = 'logit'))"
"0","summary(fit)"
"1","
Call:
"
"1","glm(formula = formula, family = binomial(link = ""logit""), data = train)"
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-2.6954  "
"1","-0.4199  "
"1"," 0.7014  "
"1"," 2.2236  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Std. Error"
"1"," z value"
"1","    "
"1","   0.6850"
"1","   2.830"
"1","              0.00465"
"1"," ** "
"1","
Pclass     "
"1","  -1.0230"
"1","     0.1086"
"1","  -9.420"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
female     "
"1","   2.6381"
"1","     0.1863"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
child      "
"1","   1.3057"
"1","     0.3269"
"1","   3.994"
"1","            0.0000649"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 1186.66  on 890  degrees of freedom
"
"1","Residual deviance:  810.89  on 887  degrees of freedom
"
"1","818.89"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","4"
"1","
"
"1","
"
"1","         llh "
"1","     llhNull "
"1","          G2 "
"1","    McFadden "
"1","        r2ML "
"1","        r2CU "
"1","
"
"1","-405.4472535 "
"1","-593.3275684 "
"1"," 375.7606299 "
"1","   0.3166553 "
"1","   0.3440883 "
"1","   0.4675083 "
"1","
"
"0","test <- read_csv(""titanic/test.csv"")"
"2","Parsed with column specification:
cols(
  PassengerId = col_integer(),
  Pclass = col_integer(),
  Name = col_character(),
  Sex = col_character(),
  Age = col_double(),
  SibSp = col_integer(),
  Parch = col_integer(),
  Ticket = col_character(),
  Fare = col_double(),
  Cabin = col_character(),
  Embarked = col_character()
)
"
"0","test <- test%>%mutate(female = case_when(Sex=='female' ~ 1,"
"0","                                  T ~ 0),"
"0","                        child = case_when(Age <= 10 ~ 1,"
"0","                                 T ~ 0)"
"0","                        )"
"0","test$Fare[is.na(test$Fare)] <- mean(train$Fare,na.rm = T"
"0","                )"
"0","                 "
"0","require(caret)"
"0","pred = predict(fit, newdata=test,type = ""response"")                 "
"0","test$Survived = ifelse(pred > 0.60,1,0)"
"0","#draw_confusion_matrix(confusionMatrix(factor(test$pred2),factor(test$survived)))"
"0","print_test <- test%>%select('PassengerId','Survived')"
"0","write_csv(print_test,'upload.csv')"
