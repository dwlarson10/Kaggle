"0","require(tidyverse)"
"0","#source(""C:Users/dwl37/OneDrive - drexel.edu/R Analysis/Confusion.R"")"
"0","train <- train%>%mutate(female = case_when(Sex=='female' ~ 1,"
"0","                                  T ~ 0))"
"0","formula <- Survived ~ Pclass + female + Fare"
"0","fit <- glm(formula,data=train,family = binomial(link = 'logit'))"
"0","summary(fit)"
"1","
Call:
"
"1","glm(formula = formula, family = binomial(link = ""logit""), data = train)"
"1","

"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-2.2492  "
"1","-0.6933  "
"1","-0.4526  "
"1"," 0.6799  "
"1"," 2.1632  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1","  0.51308"
"1","    0.30858"
"1","   1.663"
"1","   0.0964"
"1"," .  "
"1","
Pclass     "
"1"," -0.91717"
"1","    0.12194"
"1","  -7.522"
"1"," 5.41e-14"
"1"," ***"
"1","
female     "
"1","  2.63065"
"1","    0.18464"
"1","  14.247"
"1","  < 2e-16"
"1"," ***"
"1","  0.00145"
"1","   0.714"
"1","   0.4750"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1","    Null deviance: 1186.66  on 890  degrees of freedom
"
"1","Residual deviance:  826.67  on 887  degrees of freedom
"
"1","AIC: "
"1","834.67"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","4"
"1","
"
"1","
"
"0","test <- read_csv(""titanic/test.csv"")"
"2","Parsed with column specification:
cols(
  PassengerId = col_integer(),
  Pclass = col_integer(),
  Name = col_character(),
  Sex = col_character(),
  Age = col_double(),
  SibSp = col_integer(),
  Parch = col_integer(),
  Ticket = col_character(),
  Fare = col_double(),
  Cabin = col_character(),
  Embarked = col_character()
)
"
"0","test <- test%>%mutate(female = case_when(Sex=='female' ~ 1,"
"0","                                  T ~ 0))"
"0","test$Fare[is.na(test$Fare)] <- mean(train$Fare,na.rm = T"
"0","                )"
"0","                 "
"0","pred = predict(fit, newdata=test,type = ""response"")                 "
"0","test$Survived = ifelse(pred > 0.60,1,0)"
"0","#draw_confusion_matrix(confusionMatrix(factor(test$pred2),factor(test$survived)))"
"0","print_test <- test%>%select('PassengerId','Survived')"
"0","write_csv(print_test,'upload.csv')"
