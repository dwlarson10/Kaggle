"0",""
"0",""
"0","require(RODBC)"
"0","setwd(""C:/Users/dwl37/OneDrive - drexel.edu/R Analysis"")"
"0","source(""Confusion.R"")"
"0",""
"0","dbhandle <- odbcDriverConnect('Driver={SQL Server Native Client 11.0};Server=agstrat.drexel.edu,50009;Database=irae_prod;trusted_connection=yes;')"
"0","df <- sqlQuery(dbhandle, "" "
"0","SELECT *"
"0","FROM irae.Retention AS r"
"0","INNER JOIN irae.adm AS a ON a.PIDM = r.PIDM AND r.EnteringTerm = a.TERM AND a.LevelCode = r.EnteringLevelCode"
"0","LEFT JOIN Irae_Prod.irae.FinAid AS fin ON fin.PIDM = r.PIDM AND fin.AcYr = r.EnteringAcYr   "
"0","    LEFT JOIN"
"0","    ("
"0","        SELECT fst.PersonalIdentifier,"
"0","               LEFT(fst.StudentTermCode, 5) AS term5a,"
"0","               fst.GPATerm,"
"0","               fst.CreditsEarnedTerm,"
"0","               fst.CreditsAttemptedTerm,"
"0","               1.0 * CreditsEarnedTerm / CreditsAttemptedTerm AS CreditPerc"
"0","        FROM IBNSA.Final.FactStudentTerm AS fst"
"0","        WHERE fst.VersionKey = 1"
"0","              AND fst.StudentTermCode >= 201215 --in ('201735','201635','201535','201435','201335','201235')"
"0","              AND fst.CreditsAttemptedTerm > 0"
"0","    ) AS gpa"
"0","        ON r.PIDM = gpa.PersonalIdentifier"
"0","           AND gpa.term5a = r.Term5"
"0","    LEFT JOIN"
"0","    ("
"0","        SELECT PIDM,"
"0","               EnrolledInDrexel,"
"0","               EnrolledOrGradDrexel,"
"0","               EnteringTerm"
"0","        FROM irae.retention"
"0","        WHERE seq = 5"
"0","              AND UGFTFT_EnteringCohort = 1"
"0","    ) AS fallRet"
"0","        ON fallRet.PIDM = r.PIDM"
"0","           AND fallRet.EnteringTerm = r.EnteringTerm"
"0","WHERE r.UGFTFT_EnteringCohort = 1"
"0","      AND r.EnteringAcYr IN ( '20162017', '20172018', '20152016', '20142015', '20132014', '20122013','20182019' )"
"0","      AND r.Seq IN ( 1);"
"0","               "
"0","               "" )"
"0","close(dbhandle)"
